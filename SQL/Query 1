With
T1 as 
(
Select Content_ID,concat(Datepart(year,Timestamp),Datepart(week,Timestamp)) as YrWk
from Page_Impression),
T2 as 
(Select Content_ID,yrwk,count(*) as content_count,
Dense_Rank() over (Partition by YrWk order by YrWk,count(*) desc ) as rnk
from T1
where YrWk=concat(Datepart(year,getdate()),Datepart(week,getdate())) 
group by Content_ID,yrwk
)
Select * from
T2
where rownum<=5
order by yrwk,content_count desc
